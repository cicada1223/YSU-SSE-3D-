# SYSU-SSE 3D游戏编程与设计：

> 在这篇博客中，我们将探讨如何在游戏开发中将数据和游戏逻辑进行分离。我们将以一个简单的计算器作为示例，逐步展示如何使用类似于ECS（Entity-Component-System）或MVC（Model-View-Controller）模式来实现这种分离。

## 1. 为什么要分离数据和游戏逻辑？

在游戏开发中，数据和逻辑的分离有助于提高代码的可读性、可维护性和可扩展性。特别是在游戏的复杂度提升时，这种设计模式能让我们更清晰地理解每个部分的职责，同时也更容易进行测试和调试。

通过将游戏模型（数据）、组件（控制器）和系统（视图渲染）分离，我们可以在修改游戏的显示、控制方式时不影响数据结构或核心逻辑，反之亦然。

## 2. 示例代码：简易计算器

在这个计算器例子中，我们使用C#和Unity引擎进行开发。这个简易计算器实现了基本的四则运算（加、减、乘、除），并通过GUI显示界面。通过这个例子，我们将介绍如何将数据与逻辑分离。

![image-20241014114656208](../../../AppData/Roaming/Typora/typora-user-images/image-20241014114656208.png)

在这个例子中，我们将程序分成了三部分：

- **模型**负责存储数据，它们的状态不直接被视图修改。
- **控制器**负责管理模型的变化，它响应用户的操作并更新模型。
- **系统**负责渲染模型的状态，将数据呈现在用户界面上。

####  模型（Model）：数据

```csharp
private char[,] Board;
private string s;
```

模型部分主要包括了计算器的状态和数据：计算器的打印字符串 `s` 和键盘布局 `Board`。这些数据反映了用户输入的表达式和显示的按钮内容。

#### 控制器（Components/Controls）：响应用户输入

```csharp
void CalculateResult() {
    try {
    var result = new DataTable().Compute(s, null);
    s=result.ToString();
    } catch (System.Exception e) {
        // 如果出现异常（例如输入不合法的表达式），显示错误信息
        s = "Error: " + e.Message;
    }
}
```

控制器部分示例的作用是响应用户的“=”按钮，输出正确的结果。当用户点击“=”按钮时，将调用该函数，处理了打印字符串使其显示正确的结果内容。

#### 系统（System）：渲染视图

```csharp
void OnGUI() {
    GUI.Box(new Rect(255, 20, 280, 350), "");
    GUI.Box(new Rect(255, 20, 280, 70), s, centeredStyle);
}
```

系统部分负责将模型中的数据渲染到屏幕上。在 `OnGUI()` 方法中，我们通过GUI界面显示输入和按钮。系统从模型中读取数据（如字符串 `s`），并将其以适当的方式渲染到屏幕上。



## 3. 应用场景和扩展

这种模式非常适合于开发各类游戏，例如回合制策略游戏、模拟经营类游戏等。通过将数据与游戏逻辑分离，我们可以轻松调整界面或控制方式，而不必担心对核心游戏逻辑的影响。

如果要将该模式应用于更复杂的游戏（如Snake类游戏），可以通过将每个游戏对象（如蛇、食物）建模为实体，每个实体的状态和行为通过组件进行定义和管理，而渲染部分则作为独立的系统进行处理。

## 4. 总结

通过这个简易计算器的例子，我们展示了如何在游戏开发中实现数据和逻辑的分离。使用类似ECS或MVC的模式，可以提高游戏的可维护性和扩展性，使得开发者能够更轻松地进行功能扩展或界面优化。希望这个例子能对你的游戏开发有所启发！

代码（Assets文件夹）地址：[YSU-SSE-3D-/ at main · cicada1223/YSU-SSE-3D- (github.com)](https://github.com/cicada1223/YSU-SSE-3D-/tree/main)

演示视频：[自制计算机_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV12RmGY6Ege/?spm_id_from=333.999.0.0&vd_source=b5e5b58df5584430b5f5e1c8be8669a6)
